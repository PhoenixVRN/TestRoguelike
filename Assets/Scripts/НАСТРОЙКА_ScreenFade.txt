═══════════════════════════════════════════════════════════════
    🎬 SCREEN FADE - ЗАТЕМНЕНИЕ ЭКРАНА (DOTWEEN)
═══════════════════════════════════════════════════════════════

Красивый переход между волнами с затемнением!

═══════════════════════════════════════════════════════════════
📦 ТРЕБОВАНИЯ
═══════════════════════════════════════════════════════════════

✅ DOTween установлен (у вас уже есть)

Если DOTween не импортирован в коде:
  Tools → Demigiant → DOTween Utility Panel → Setup DOTween

═══════════════════════════════════════════════════════════════
📋 ШАГ 1: СОЗДАТЬ UI ДЛЯ ЗАТЕМНЕНИЯ
═══════════════════════════════════════════════════────────════

Hierarchy → Canvas (корневой UI):

1. ПКМ на Canvas → UI → Image
2. Назовите "ScreenFadePanel"

3. Inspector → Rect Transform:
   ┌────────────────────────────────────┐
   │ Anchors: Stretch-Stretch ⭐        │
   │ Left: 0, Right: 0                  │
   │ Top: 0, Bottom: 0                  │
   │ (покрывает весь экран!)            │
   └────────────────────────────────────┘

4. Inspector → Image:
   ┌────────────────────────────────────┐
   │ Source Image: None (просто цвет)   │
   │ Color: Чёрный (0, 0, 0, 0) ⭐     │
   │        ^Alpha = 0 (прозрачный!)    │
   │ Raycast Target: ✓                  │
   │ (блокирует клики во время fade)    │
   └────────────────────────────────────┘

5. ВАЖНО: Переместите ScreenFadePanel В САМЫЙ ВЕРХ Hierarchy!
   (должен быть последним ребёнком Canvas - рисуется поверх всего)

═══════════════════════════════════════════════════════════════
📋 ШАГ 2: ДОБАВИТЬ КОМПОНЕНТ SCREEN FADE
═══════════════════════════════════════════════════════════════

ScreenFadePanel → Add Component → Screen Fade

Inspector:
┌─────────────────────────────────────────────────────────────┐
│ Screen Fade (Script)                                        │
├─────────────────────────────────────────────────────────────┤
│ ▼ Ссылки                                                    │
│   Fade Image: ScreenFadePanel ⭐                            │
│   (перетащите этот же объект или оставьте пустым -         │
│    найдёт автоматически)                                   │
│                                                             │
│ ▼ Настройки                                                 │
│   Fade In Duration: 0.5    ← Скорость затемнения           │
│   Fade Out Duration: 0.5   ← Скорость развеивания          │
│   Fade Color: Чёрный (0, 0, 0, 255)                        │
│   Fade In Ease: InQuad                                      │
│   Fade Out Ease: OutQuad                                    │
│   Show Debug: ✓                                             │
└─────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════
📋 ШАГ 3: ПОДКЛЮЧИТЬ К BATTLE MANAGER
═══════════════════════════════════════════════════════════════

BattleManager → Inspector:

┌─────────────────────────────────────────────────────────────┐
│ Battle Manager (Script)                                     │
├─────────────────────────────────────────────────────────────┤
│ ▼ Ссылки                                                    │
│   Grid Manager: Grid                                        │
│   Grid Transform: Grid                                      │
│   Game Manager: GameManager                                 │
│   Screen Fade: ScreenFadePanel ⭐ НОВОЕ!                   │
└─────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════
🎬 КАК ЭТО РАБОТАЕТ
═══════════════════════════════════════════════════════════════

Timeline после победы:

t=0:    🎉 ПОБЕДА!
        ↓
t=2:    (Victory Delay)
        ↓
t=2:    🌑 Fade In (затемнение 0.5 сек)
        Экран плавно становится чёрным...
        ↓
t=2.5:  🌑 ЭКРАН ПОЛНОСТЬЮ ЧЁРНЫЙ
        ↓
        ⚡ Grid → X=959 (МГНОВЕННО, игрок не видит!)
        ⚡ objectToMove → X=959 (МГНОВЕННО!)
        🗑️ Очистка персонажей
        ♻️ Респавн героев 👤 👤 👤
        ↓
t=3.5:  ☀️ Fade Out (развеивание 0.5 сек)
        Экран плавно проясняется...
        ↓
t=4:    ☀️ ЭКРАН ПРОЗРАЧНЫЙ
        ✅ Герои на своих местах!
        Готово к следующей волне! 🔄

═══════════════════════════════════════════════════════════════
💡 НАСТРОЙКИ FADE
═══════════════════════════════════════════════════════════════

Быстрый переход:
  Fade In Duration: 0.3
  Fade Out Duration: 0.3

Плавный переход:
  Fade In Duration: 0.7
  Fade Out Duration: 0.7

Драматичный:
  Fade In Duration: 1.0
  Fade Out Duration: 1.0

Мгновенный (без плавности):
  Fade In Duration: 0.1
  Fade Out Duration: 0.1

═══════════════════════════════════════════════════════════════
🎨 ВАРИАНТЫ EASE (плавность)
═══════════════════════════════════════════════════════════════

InQuad - медленно → быстро
OutQuad - быстро → медленно
InOutQuad - медленно → быстро → медленно
Linear - равномерно

InCubic, OutCubic - более резкие
InElastic, OutElastic - с пружинкой (не для fade!)

Рекомендую:
  Fade In Ease: InQuad (ускоряется)
  Fade Out Ease: OutQuad (замедляется)

═══════════════════════════════════════════════════════════════
🧪 ТЕСТ
═══════════════════════════════════════════════════════════════

1. Создайте ScreenFadePanel (чёрный Image на весь экран)
2. Add Component → Screen Fade
3. BattleManager → Screen Fade: ScreenFadePanel
4. Show Debug: ✓ везде

5. Play → START → Победите врагов

Должно произойти:
  🎉 Победа!
  (пауза)
  🌑 Экран темнеет... (плавно)
  🌑 ЧЁРНый экран
  (рестарт происходит)
  ☀️ Экран проясняется... (плавно)
  ✅ Герои на месте!

Console:
  🎉 ПОБЕДА!
  🌑 Затемнение экрана... (0.5с)
  🌑 Экран полностью затемнён!
  🌑 Экран затемнён - выполняем рестарт...
  📍 Grid вернулся
  ♻️ Респавним героев...
  ☀️ Развеиваем затемнение... (0.5с)
  ☀️ Затемнение развеяно!
  ✅ Готово!

═══════════════════════════════════════════════════════════════
🐛 ЧАСТЫЕ ПРОБЛЕМЫ
═══════════════════════════════════════════════════════════════

ПРОБЛЕМА: Fade не работает, ошибка "DOTween not found"
РЕШЕНИЕ:
  Tools → Demigiant → DOTween Utility Panel → Setup DOTween
  Или добавьте: using DG.Tweening;

ПРОБЛЕМА: Панель не затемняет экран
РЕШЕНИЕ:
  - ScreenFadePanel → Rect Transform: Stretch-Stretch
  - В самом верху Hierarchy (рисуется последним)

ПРОБЛЕМА: Затемнение не видно
РЕШЕНИЕ:
  - Image → Color: alpha должна меняться 0→1
  - Fade Color: установите чёрный (0,0,0,255)

ПРОБЛЕМА: Экран остаётся чёрным
РЕШЕНИЕ:
  - Проверьте что FadeOut вызывается
  - Fade Out Duration > 0

═══════════════════════════════════════════════════════════════
✅ ГОТОВО!
═══════════════════════════════════════════════════════════════

Теперь переходы между волнами выглядят профессионально! 🎬

═══════════════════════════════════════════════════════════════

